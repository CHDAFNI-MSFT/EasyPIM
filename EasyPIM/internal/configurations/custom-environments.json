{
    "description": "Configuration file for custom Azure environments and Microsoft Graph endpoints",
    "version": "1.0",
    "environments": {
        "AzureStackProd": {
            "graphEndpoint": "https://graph.azurestack.contoso.com",
            "notes": "Production Azure Stack environment"
        },
        "AzureStackDev": {
            "graphEndpoint": "https://graph.dev.azurestack.contoso.com",
            "notes": "Development Azure Stack environment"
        },
        "PrivateCloud": {
            "graphEndpoint": "https://graph.private.cloud",
            "notes": "Internal private cloud environment"
        }
    },
    "inferenceRules": {
        "description": "Patterns for inferring Graph endpoints from Azure AD authorities",
        "patterns": [
            {
                "authorityPattern": "*.azurestack.*",
                "graphPattern": "replace:login->graph",
                "description": "Azure Stack pattern: replace 'login' with 'graph' in authority URL"
            },
            {
                "authorityPattern": "*.private.cloud",
                "graphPattern": "replace:login->graph",
                "description": "Private cloud pattern: replace 'login' with 'graph' in authority URL"
            }
        ]
    },
    "usage": {
        "configurationFile": "Place custom environment configurations in the 'environments' section above",
        "environmentVariables": "Set EASYPIM_GRAPH_ENDPOINT_<ENVIRONMENTNAME> environment variables (e.g., EASYPIM_GRAPH_ENDPOINT_AZURESTACKPROD)",
        "registration": "Register custom environments with Microsoft.Graph module using Add-MgEnvironment cmdlet"
    }
}
